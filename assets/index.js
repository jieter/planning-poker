var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,...n){if(null==e){for(const t of n)t(void 0);return t}const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function s(t,e,n){t.$$.on_destroy.push(i(e,n))}function l(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function g(){return m(" ")}function h(){return m("")}function v(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.data!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function x(t,e,n,r){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function k(t,e,n){t.classList.toggle(e,!!n)}let w;function _(t){w=t}function S(t){(function(){if(!w)throw new Error("Function called outside component initialization");return w})().$$.on_mount.push(t)}function C(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const N=[],E=[];let O=[];const R=[],W=Promise.resolve();let A=!1;function j(t){O.push(t)}const J=new Set;let M=0;function z(){if(0!==M)return;const t=w;do{try{for(;M<N.length;){const t=N[M];M++,_(t),I(t.$$)}}catch(t){throw N.length=0,M=0,t}for(_(null),N.length=0,M=0;E.length;)E.pop()();for(let t=0;t<O.length;t+=1){const e=O[t];J.has(e)||(J.add(e),e())}O.length=0}while(N.length);for(;R.length;)R.pop()();A=!1,J.clear(),_(t)}function I(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}const P=new Set;let G;function X(){G={r:0,c:[],p:G}}function B(){G.r||r(G.c),G=G.p}function T(t,e){t&&t.i&&(P.delete(t),t.i(e))}function F(t,e,n,r){if(t&&t.o){if(P.has(t))return;P.add(t),G.c.push((()=>{P.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}function L(t){return void 0!==t?.length?t:Array.from(t)}function U(t,e){F(t,1,1,(()=>{e.delete(t.key)}))}function D(t,e,n,o,c,i,s,l,a,u,d,f){let p=t.length,m=i.length,g=p;const h={};for(;g--;)h[t[g].key]=g;const v=[],$=new Map,b=new Map,y=[];for(g=m;g--;){const t=f(c,i,g),r=n(t);let l=s.get(r);l?o&&y.push((()=>l.p(t,e))):(l=u(r,t),l.c()),$.set(r,v[g]=l),r in h&&b.set(r,Math.abs(g-h[r]))}const x=new Set,k=new Set;function w(t){T(t,1),t.m(l,d),s.set(t.key,t),d=t.first,m--}for(;p&&m;){const e=v[m-1],n=t[p-1],r=e.key,o=n.key;e===n?(d=e.first,p--,m--):$.has(o)?!s.has(r)||x.has(r)?w(e):k.has(o)?p--:b.get(r)>b.get(o)?(k.add(r),w(e)):(x.add(o),p--):(a(n,s),p--)}for(;p--;){const e=t[p];$.has(e.key)||a(e,s)}for(;m;)w(v[m-1]);return r(y),v}function H(t){t&&t.c()}function q(t,n,c){const{fragment:i,after_update:s}=t.$$;i&&i.m(n,c),j((()=>{const n=t.$$.on_mount.map(e).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...n):r(n),t.$$.on_mount=[]})),s.forEach(j)}function Y(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];O.forEach((r=>-1===t.indexOf(r)?e.push(r):n.push(r))),n.forEach((t=>t())),O=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function V(t,e){-1===t.$$.dirty[0]&&(N.push(t),A||(A=!0,W.then(z)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,o,c,i,s,l,a,u=[-1]){const f=w;_(e);const p=e.$$={fragment:null,ctx:[],props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(f?f.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:o.target||f.$$.root};a&&a(p.root);let m=!1;if(p.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&s(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),m&&V(e,t)),n})):[],p.update(),m=!0,r(p.before_update),p.fragment=!!i&&i(p.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();o.intro&&T(e.$$.fragment),q(e,o.target,o.anchor),z()}_(f)}class Q{$$=void 0;$$set=void 0;$destroy(){Y(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}
/*! js-cookie v3.0.5 | MIT */
function Z(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");var tt=function t(e,n){function r(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=Z({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var i in o)o[i]&&(c+="; "+i,!0!==o[i]&&(c+="="+o[i].split(";")[0]));return document.cookie=t+"="+e.write(r,t)+c}}return Object.create({set:r,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var c=n[o].split("="),i=c.slice(1).join("=");try{var s=decodeURIComponent(c[0]);if(r[s]=e.read(i,s),t===s)break}catch(t){}}return t?r[t]:r}},remove:function(t,e){r(t,"",Z({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,Z({},this.attributes,e))},withConverter:function(e){return t(Z({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function et(t){let e=document.getElementById(t);if(e)return JSON.parse(e.textContent)}function nt(t){let e,n;return{c(){e=p("div"),n=m(t[2]),$(e,"class","invalid-feedback")},m(t,r){u(t,e,r),a(e,n)},p(t,e){4&e&&b(n,t[2])},d(t){t&&d(e)}}}function rt(e){let n,o,c,i,s,l,f,h,b,x,w,_,S,C,N,E,O,R,W,A,j=e[2]&&nt(e);return{c(){n=p("h1"),n.textContent="Planning poker",o=g(),c=p("form"),i=p("div"),s=p("input"),l=g(),f=p("div"),h=p("input"),b=g(),j&&j.c(),x=g(),w=p("div"),w.innerHTML='<input type="submit" class="btn btn-primary" value="Join"/>',_=g(),S=p("div"),C=p("label"),N=p("input"),E=m(" Join as a spectator ðŸ‘ï¸"),O=g(),R=p("span"),R.textContent="You can always enab to voting later",$(s,"type","hidden"),$(s,"name","csrfmiddlewaretoken"),s.value=tt.get("csrftoken"),$(h,"type","text"),$(h,"name","name"),$(h,"class","form-control"),k(h,"is-invalid",e[2]),$(f,"class","col"),$(w,"class","col"),$(i,"class","row row-cols-lg-auto"),$(N,"type","checkbox"),$(N,"name","is_spectator"),$(C,"class","col"),$(R,"class","text-muted"),$(S,"class","row"),$(c,"method","post")},m(t,r){u(t,n,r),u(t,o,r),u(t,c,r),a(c,i),a(i,s),a(i,l),a(i,f),a(f,h),y(h,e[0]),a(f,b),j&&j.m(f,null),a(i,x),a(i,w),a(c,_),a(c,S),a(S,C),a(C,N),N.checked=e[1],a(C,E),a(S,O),a(S,R),W||(A=[v(h,"change",e[3]),v(h,"input",e[4]),v(N,"change",e[5])],W=!0)},p(t,[e]){1&e&&h.value!==t[0]&&y(h,t[0]),4&e&&k(h,"is-invalid",t[2]),t[2]?j?j.p(t,e):(j=nt(t),j.c(),j.m(f,null)):j&&(j.d(1),j=null),2&e&&(N.checked=t[1])},i:t,o:t,d(t){t&&(d(n),d(o),d(c)),j&&j.d(),W=!1,r(A)}}}function ot(t,e,n){let r,o="",c=null;S((()=>{const t=localStorage.getItem("name");t&&n(0,o=t);const e=localStorage.getItem("isSpectator");null!==e&&n(1,c="true"===e)}));return t.$$.update=()=>{1&t.$$.dirty&&o&&localStorage.setItem("name",o),2&t.$$.dirty&&null!=c&&localStorage.setItem("isSpectator",c?"true":"false")},[o,c,r,()=>{n(2,r=o?void 0:"Name cannot be empty")},function(){o=this.value,n(0,o)},function(){c=this.checked,n(1,c)}]}class ct extends Q{constructor(t){super(),K(this,t,ot,rt,c,{})}}function it(t){let e,n,o,c;const i=t[3].default,s=function(t,e,n,r){if(t){const o=l(t,e,n,r);return t[0](o)}}(i,t,t[2],null);return{c(){e=p("div"),s&&s.c(),$(e,"class","card btn svelte-2owq3i"),$(e,"disabled",t[0]),$(e,"role","button"),$(e,"tabindex","0"),k(e,"selected",t[1])},m(r,i){u(r,e,i),s&&s.m(e,null),n=!0,o||(c=[v(e,"click",t[4]),v(e,"keypress",t[5])],o=!0)},p(t,[r]){s&&s.p&&(!n||4&r)&&function(t,e,n,r,o,c){if(o){const i=l(e,n,r,c);t.p(i,o)}}(s,i,t,t[2],n?function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(i,t[2],r,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[2]),null),(!n||1&r)&&$(e,"disabled",t[0]),(!n||2&r)&&k(e,"selected",t[1])},i(t){n||(T(s,t),n=!0)},o(t){F(s,t),n=!1},d(t){t&&d(e),s&&s.d(t),o=!1,r(c)}}}function st(t,e,n){let{$$slots:r={},$$scope:o}=e,{disabled:c=!0}=e,{selected:i=""}=e;return t.$$set=t=>{"disabled"in t&&n(0,c=t.disabled),"selected"in t&&n(1,i=t.selected),"$$scope"in t&&n(2,o=t.$$scope)},[c,i,o,r,function(e){C.call(this,t,e)},function(e){C.call(this,t,e)}]}class lt extends Q{constructor(t){super(),K(this,t,st,it,c,{disabled:0,selected:1})}}function at(t){let e;function n(t,e){return t[1]?ft:dt}let r=n(t),o=r(t);return{c(){o.c(),e=h()},m(t,n){o.m(t,n),u(t,e,n)},p(t,c){r===(r=n(t))&&o?o.p(t,c):(o.d(1),o=r(t),o&&(o.c(),o.m(e.parentNode,e)))},d(t){t&&d(e),o.d(t)}}}function ut(e){let n;return{c(){n=m("ðŸ‘ï¸")},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function dt(e){let n;return{c(){n=m("âŒ›")},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function ft(t){let e,n=t[0].vote+"";return{c(){e=m(n)},m(t,n){u(t,e,n)},p(t,r){1&r&&n!==(n=t[0].vote+"")&&b(e,n)},d(t){t&&d(e)}}}function pt(t){let e;function n(t,e){return t[0].is_spectator?ut:t[0].vote?at:void 0}let r=n(t),o=r&&r(t);return{c(){o&&o.c(),e=h()},m(t,n){o&&o.m(t,n),u(t,e,n)},p(t,c){r===(r=n(t))&&o?o.p(t,c):(o&&o.d(1),o=r&&r(t),o&&(o.c(),o.m(e.parentNode,e)))},d(t){t&&d(e),o&&o.d(t)}}}function mt(t){let e,n,r,o,c,i,s=t[0].name+"";return c=new lt({props:{$$slots:{default:[pt]},$$scope:{ctx:t}}}),{c(){e=p("div"),n=p("strong"),r=m(s),o=g(),H(c.$$.fragment),$(e,"class","participant svelte-10w4gcr"),x(e,"transform","rotate("+t[2]+"deg) translate(37.5vw) rotate(90deg)")},m(t,s){u(t,e,s),a(e,n),a(n,r),a(e,o),q(c,e,null),i=!0},p(t,[n]){(!i||1&n)&&s!==(s=t[0].name+"")&&b(r,s);const o={};35&n&&(o.$$scope={dirty:n,ctx:t}),c.$set(o),(!i||4&n)&&x(e,"transform","rotate("+t[2]+"deg) translate(37.5vw) rotate(90deg)")},i(t){i||(T(c.$$.fragment,t),i=!0)},o(t){F(c.$$.fragment,t),i=!1},d(t){t&&d(e),Y(c)}}}function gt(t,e,n){let r,{user:o}=e,{isRevealed:c}=e,{i:i}=e,{count:s}=e;return t.$$set=t=>{"user"in t&&n(0,o=t.user),"isRevealed"in t&&n(1,c=t.isRevealed),"i"in t&&n(3,i=t.i),"count"in t&&n(4,s=t.count)},t.$$.update=()=>{28&t.$$.dirty&&(n(2,r=-90),s>1&&n(2,r-=Math.min(20,174/s)*(i-(s-1)/2)))},[o,c,r,i,s]}class ht extends Q{constructor(t){super(),K(this,t,gt,mt,c,{user:0,isRevealed:1,i:3,count:4})}}const vt=[];function $t(e,n=t){let r;const o=new Set;function i(t){if(c(e,t)&&(e=t,r)){const t=!vt.length;for(const t of o)t[1](),vt.push(t,e);if(t){for(let t=0;t<vt.length;t+=2)vt[t][0](vt[t+1]);vt.length=0}}}function s(t){i(t(e))}return{set:i,update:s,subscribe:function(c,l=t){const a=[c,l];return o.add(a),1===o.size&&(r=n(i,s)||t),c(e),()=>{o.delete(a),0===o.size&&r&&(r(),r=null)}}}}const bt=$t([]),yt=$t([]),xt=$t([]),kt=$t(!1),wt=$t("tshirt"),_t=$t(!1),St=$t({}),Ct=$t(void 0),Nt=function(e,n,c){const s=!Array.isArray(e),l=s?[e]:e;if(!l.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=n.length<2;return u=(e,c)=>{let u=!1;const d=[];let f=0,p=t;const m=()=>{if(f)return;p();const r=n(s?d[0]:d,e,c);a?e(r):p=o(r)?r:t},g=l.map(((t,e)=>i(t,(t=>{d[e]=t,f&=~(1<<e),u&&m()}),(()=>{f|=1<<e}))));return u=!0,m(),function(){r(g),p(),u=!1}},{subscribe:$t(c,u).subscribe};var u}(bt,(t=>{const e=new Proxy({},{get:(t,e)=>e in t?t[e]:0});return t.forEach((t=>{null!=t.vote&&(e[t.vote]+=1)})),Object.entries(e).sort(((t,e)=>e[1]-t[1]))})),Et=t=>{St.update((e=>(e.vote=t,e)))};let Ot;function Rt(t,e=void 0){Ot&&1==Ot.readyState?((e=e||{}).action=t,console.log("update",e),Ot.send(JSON.stringify(e))):console.log("Socket not open yet")}function Wt(t){Ot=new WebSocket(t),Ot.onclose=()=>{Ct.set("WebSocket connection closed unexpectedly. Trying to reconnect in 2s..."),setTimeout((()=>{console.log("Reconnecting..."),Wt(t)}),2e3)},Ot.onopen=()=>{Rt({action:"init"})},Ot.onmessage=t=>{const e=JSON.parse(t.data);switch(console.log("message",e),e.type){case"init":bt.set(e.users),St.set(e.user),yt.set(e.settings.choices),kt.set(e.settings.auto_reveal),_t.set(e.settings.is_revealed),xt.set(e.settings.decks),wt.set(e.settings.deck),Ct.set(void 0);break;case"vote":bt.update((t=>(t.forEach((t=>{t.id==e.user_id&&(t.vote=e.value)})),[...t])));break;case"error":Ct.set(e.message)}}}const At=()=>Rt("reveal"),jt=()=>{Et(null),Rt("clear")};function Jt(t){return()=>{(function(t){let e;return i(t,(t=>e=t))(),e})(_t)||(Rt("vote",{value:t}),Et(t))}}function Mt(t,e,n){const r=t.slice();return r[7]=e[n][0],r[8]=e[n][1],r}function zt(t){let e,n,r,o,c,i,s,l,f,h,x,k=!1,w=t[8]+"";return f=function(t){let e;return{p(...n){e=n,e.forEach((e=>t.push(e)))},r(){e.forEach((e=>t.splice(t.indexOf(e),1)))}}}(t[5][0]),{c(){e=p("input"),c=g(),i=p("label"),s=m(w),$(e,"type","radio"),$(e,"class","btn-check"),e.__value=n=t[7],y(e,e.__value),$(e,"autocomplete","off"),$(e,"id",r="deck-"+t[7]),e.disabled=o=!t[1],$(i,"class","btn btn-outline-primary svelte-1m1fa2z"),$(i,"for",l="deck-"+t[7]),f.p(e)},m(n,r){u(n,e,r),e.checked=e.__value===t[2],u(n,c,r),u(n,i,r),a(i,s),h||(x=v(e,"change",t[4]),h=!0)},p(t,c){1&c&&n!==(n=t[7])&&(e.__value=n,y(e,e.__value),k=!0),1&c&&r!==(r="deck-"+t[7])&&$(e,"id",r),2&c&&o!==(o=!t[1])&&(e.disabled=o),(k||5&c)&&(e.checked=e.__value===t[2]),1&c&&w!==(w=t[8]+"")&&b(s,w),1&c&&l!==(l="deck-"+t[7])&&$(i,"for",l)},d(t){t&&(d(e),d(c),d(i)),f.r(),h=!1,x()}}}function It(e){let n,r,o,c,i,s,l,h,b,y=L(e[0]),x=[];for(let t=0;t<y.length;t+=1)x[t]=zt(Mt(e,y,t));return{c(){n=p("div"),r=p("div");for(let t=0;t<x.length;t+=1)x[t].c();o=m("\n    Â \n\n    "),c=p("div"),i=p("label"),i.textContent="Auto reveal",s=g(),l=p("input"),$(r,"class","btn-group btn-group-sm"),$(r,"role","group"),$(r,"aria-label","Change deck"),$(i,"for","autoReveal"),$(i,"class","svelte-1m1fa2z"),$(l,"type","checkbox"),$(l,"class","form-check-input"),$(l,"id","autoReveal"),$(c,"class","form-check form-switch mt-2"),$(n,"class","d-flex justify-content-center m-3")},m(t,d){u(t,n,d),a(n,r);for(let t=0;t<x.length;t+=1)x[t]&&x[t].m(r,null);a(n,o),a(n,c),a(c,i),a(c,s),a(c,l),l.checked=e[3],h||(b=v(l,"change",e[6]),h=!0)},p(t,[e]){if(7&e){let n;for(y=L(t[0]),n=0;n<y.length;n+=1){const o=Mt(t,y,n);x[n]?x[n].p(o,e):(x[n]=zt(o),x[n].c(),x[n].m(r,null))}for(;n<x.length;n+=1)x[n].d(1);x.length=y.length}8&e&&(l.checked=t[3])},i:t,o:t,d(t){t&&d(n),f(x,t),h=!1,b()}}}function Pt(t,e,n){let r,o,c,i;s(t,xt,(t=>n(0,r=t))),s(t,_t,(t=>n(1,o=t))),s(t,wt,(t=>n(2,c=t))),s(t,kt,(t=>n(3,i=t)));return[r,o,c,i,function(){c=this.__value,wt.set(c)},[[]],function(){i=this.checked,kt.set(i)}]}wt.subscribe((t=>Rt("settings",{deck:t}))),kt.subscribe((t=>Rt("settings",{auto_reveal:t})));class Gt extends Q{constructor(t){super(),K(this,t,Pt,It,c,{})}}function Xt(e){let n,o,c,i,s,l,f,h,y,x,k,w,_,S,C,N,E,O,R,W,A,j=JSON.stringify(e[0])+"",J=JSON.stringify(e[1])+"",M=JSON.stringify(e[2])+"",z=JSON.stringify(e[3])+"",I=!e[4]&&function(t){let e,n,o,c,i,s,l;return{c(){e=m("Fake:\n        "),n=p("div"),o=p("button"),o.textContent="Users",c=g(),i=p("button"),i.textContent="Votes",$(o,"class","btn btn-warning"),$(i,"class","btn btn-warning"),$(n,"class","btn-group btn-group-sm"),$(n,"role","group")},m(r,d){u(r,e,d),u(r,n,d),a(n,o),a(n,c),a(n,i),s||(l=[v(o,"click",t[11]),v(i,"click",t[12])],s=!0)},d(t){t&&(d(e),d(n)),s=!1,r(l)}}}(e);return{c(){n=p("div"),o=p("div"),o.textContent="debug",c=g(),i=p("code"),s=m(j),l=g(),f=p("div"),h=m("votes: "),y=p("code"),x=m(J),k=g(),w=p("div"),_=m("user: "),S=p("code"),C=m(M),N=g(),E=p("div"),O=m("participants: "),R=p("code"),W=m(z),A=g(),I&&I.c(),$(n,"class","bg-light rounded p-2")},m(t,e){u(t,n,e),a(n,o),a(n,c),a(n,i),a(i,s),a(n,l),a(n,f),a(f,h),a(f,y),a(y,x),a(n,k),a(n,w),a(w,_),a(w,S),a(S,C),a(n,N),a(n,E),a(E,O),a(E,R),a(R,W),a(n,A),I&&I.m(n,null)},p(t,[e]){1&e&&j!==(j=JSON.stringify(t[0])+"")&&b(s,j),2&e&&J!==(J=JSON.stringify(t[1])+"")&&b(x,J),4&e&&M!==(M=JSON.stringify(t[2])+"")&&b(C,M),8&e&&z!==(z=JSON.stringify(t[3])+"")&&b(W,z)},i:t,o:t,d(t){t&&d(n),I&&I.d()}}}function Bt(t,e,n){let r,o,c,i,l,a,u,d,f,p;s(t,kt,(t=>n(5,o=t))),s(t,_t,(t=>n(6,c=t))),s(t,yt,(t=>n(7,i=t))),s(t,xt,(t=>n(8,l=t))),s(t,wt,(t=>n(9,a=t))),s(t,Ct,(t=>n(10,u=t))),s(t,Nt,(t=>n(1,d=t))),s(t,St,(t=>n(2,f=t))),s(t,bt,(t=>n(3,p=t)));const m=!window.location.host.includes("localhost");return t.$$.update=()=>{2016&t.$$.dirty&&n(0,r={error:u,deck:a,decks:l,choices:i,isRevealed:c,autoReveal:o})},[r,d,f,p,m,o,c,i,l,a,u,()=>Rt("add_fakes"),()=>Rt("fake_votes")]}class Tt extends Q{constructor(t){super(),K(this,t,Bt,Xt,c,{})}}const Ft=(t,e={})=>{de(e);let{colors:n=["#FFC700","#FF0000","#2E3191","#41BBC7"],duration:r=3500,force:o=.5,particleCount:c=150,particleShape:i="mix",particleSize:s=12,destroyAfterDone:l=!0,stageHeight:a=800,stageWidth:u=1600}=e;!function(t){const e=te("style");e.dataset.neoconfetti="",e.textContent='@keyframes fk9XWG_y-axis{to{transform:translate3d(0,var(--stage-height),0)}}@keyframes fk9XWG_x-axis{to{transform:translate3d(var(--x-landing-point),0,0)}}@keyframes fk9XWG_rotation{50%{transform:rotate3d(var(--half-rotation),180deg)}to{transform:rotate3d(var(--rotation),360deg)}}.fk9XWG_container{width:0;height:0;z-index:1200;position:relative;overflow:visible}.fk9XWG_particle{animation:x-axis var(--duration-chaos)forwards cubic-bezier(var(--x1),var(--x2),var(--x3),var(--x4));animation-name:fk9XWG_x-axis}.fk9XWG_particle>div{animation:y-axis var(--duration-chaos)forwards cubic-bezier(var(--y1),var(--y2),var(--y3),var(--y4));width:var(--width);height:var(--height);animation-name:fk9XWG_y-axis;position:absolute;top:0;left:0}.fk9XWG_particle>div:before{height:100%;width:100%;content:"";background-color:var(--bgcolor);animation:rotation var(--rotation-duration)infinite linear;border-radius:var(--border-radius);animation-name:fk9XWG_rotation;display:block}',ee(document.head,e)}(),t.classList.add("fk9XWG_container"),t.style.setProperty("--stage-height",a+"px");let d,f=ne(c,n),p=Lt(t,f);function m(t,e){const n=Qt(Kt()*(se-1)),c="rectangles"!==i&&("circles"===i||le(n)),l=(e,n)=>t.style.setProperty(e,n+"");l("--x-landing-point",oe(Vt(ce(e,90)-180),0,180,-u/2,u/2)+"px"),l("--duration-chaos",r-Qt(1e3*Kt())+"ms");const a=Kt()<Ht?re(Kt()*qt,2):0;l("--x1",a),l("--x2",-1*a),l("--x3",a),l("--x4",re(Vt(oe(Vt(ce(e,90)-180),0,180,-1,1)),4)),l("--y1",re(Kt()*Yt,4)),l("--y2",re(Kt()*o*(ie()?1:-1),4)),l("--y3",Yt),l("--y4",re(Zt(oe(Vt(e-180),0,180,o,-o),0),4)),l("--width",(c?s:Qt(4*Kt())+s/2)+"px"),l("--height",(c?s:Qt(2*Kt())+s)+"px");const d=n.toString(2).padStart(3,"0").split("");l("--half-rotation",d.map((t=>+t/2+""))),l("--rotation",d),l("--rotation-duration",re(Kt()*(Dt-Ut)+Ut)+"ms"),l("--border-radius",c?"50%":0)}for(const[t,e]of Object.entries(p))m(e,f[+t].degree);return Promise.resolve().then((()=>d=setTimeout((()=>l&&(t.innerHTML="")),r))),{update(e){de(e);const m=e.particleCount??c,g=e.colors??n,h=e.stageHeight??a;if(f=ne(m,g),m===c&&JSON.stringify(n)!==JSON.stringify(g))for(const[t,{color:e}]of Object.entries(f))p[+t].style.setProperty("--bgcolor",e);m!==c&&(t.innerHTML="",p=Lt(t,f)),l&&!e.destroyAfterDone&&clearTimeout(d),t.style.setProperty("--stage-height",h+"px"),n=g,r=e.duration??r,o=e.force??o,c=m,i=e.particleShape??i,s=e.particleSize??s,l=e.destroyAfterDone??l,a=h,u=e.stageWidth??u},destroy(){clearTimeout(d)}}};function Lt(t,e=[]){const n=[];for(const{color:r}of e){const e=te("div");e.className="fk9XWG_particle",e.style.setProperty("--bgcolor",r);const o=te("div");ee(e,o),ee(t,e),n.push(e)}return n}const Ut=200,Dt=800,Ht=.1,qt=.3,Yt=.5,Vt=Math.abs,Kt=Math.random,Qt=Math.round,Zt=Math.max,te=t=>document.createElement(t),ee=(t,e)=>t.appendChild(e),ne=(t,e)=>Array.from({length:t},((n,r)=>({color:e[r%e.length],degree:360*r/t}))),re=(t,e=2)=>Qt((t+Number.EPSILON)*10**e)/10**e,oe=(t,e,n,r,o)=>(t-e)*(o-r)/(n-e)+r,ce=(t,e)=>t+e>360?t+e-360:t+e,ie=()=>Kt()>.5,se=6,le=t=>1!==t&&ie(),ae=t=>void 0===t,ue=(t,e)=>{if(!ae(t)&&Number.isSafeInteger(t)&&t<0)throw new Error(e+" must be a positive integer")},de=({particleCount:t,duration:e,colors:n,particleSize:r,force:o,stageHeight:c,stageWidth:i,particleShape:s})=>{if(ue(t,"particleCount"),ue(e,"duration"),ue(r,"particleSize"),ue(o,"force"),ue(c,"stageHeight"),ue(i,"stageWidth"),!ae(s)&&!/^(mix|circles|rectangles)$/i.test(s))throw new Error('particlesShape should be either "mix" or "circles" or "rectangle"');if(!ae(n)&&!Array.isArray(n))throw new Error("colors must be an array of strings");if(o>1)throw new Error("force must be within 0 and 1")};function fe(t,e,n){const r=t.slice();return r[1]=e[n][0],r[2]=e[n][1],r}function pe(e){let n,r,c;return{c(){n=p("div")},m(e,i){var s;u(e,n,i),r||(s=Ft.call(null,n),c=s&&o(s.destroy)?s.destroy:t,r=!0)},d(t){t&&d(n),r=!1,c()}}}function me(e){let n;return{c(){n=p("div"),n.textContent="No votes",$(n,"class","col text-center")},m(t,e){u(t,n,e)},p:t,d(t){t&&d(n)}}}function ge(t){let e,n=t[1]+"";return{c(){e=m(n)},m(t,n){u(t,e,n)},p(t,r){1&r&&n!==(n=t[1]+"")&&b(e,n)},d(t){t&&d(e)}}}function he(t,e){let n,r,o,c,i,s,l,f,h=e[2]+"";return r=new lt({props:{$$slots:{default:[ge]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=p("div"),H(r.$$.fragment),o=g(),c=p("div"),i=m(h),s=m("x"),l=g(),$(c,"class","text-muted"),$(n,"class","d-inline-block text-center m-2"),this.first=n},m(t,e){u(t,n,e),q(r,n,null),a(n,o),a(n,c),a(c,i),a(c,s),a(n,l),f=!0},p(t,n){e=t;const o={};33&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o),(!f||1&n)&&h!==(h=e[2]+"")&&b(i,h)},i(t){f||(T(r.$$.fragment,t),f=!0)},o(t){F(r.$$.fragment,t),f=!1},d(t){t&&d(n),Y(r)}}}function ve(t){let e,n,r,o=[],c=new Map,i=t[0]&&1==t[0].length&&t[0][0][1]>1&&pe(),s=L(t[0]);const l=t=>t[1];for(let e=0;e<s.length;e+=1){let n=fe(t,s,e),r=l(n);c.set(r,o[e]=he(r,n))}let a=null;return s.length||(a=me()),{c(){i&&i.c(),e=g(),n=p("div");for(let t=0;t<o.length;t+=1)o[t].c();a&&a.c(),$(n,"class","summary rounded mb-3 text-center svelte-xmidgi")},m(t,c){i&&i.m(t,c),u(t,e,c),u(t,n,c);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(n,null);a&&a.m(n,null),r=!0},p(t,[r]){t[0]&&1==t[0].length&&t[0][0][1]>1?i||(i=pe(),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),1&r&&(s=L(t[0]),X(),o=D(o,r,l,1,t,s,c,n,U,he,null,fe),B(),!s.length&&a?a.p(t,r):s.length?a&&(a.d(1),a=null):(a=me(),a.c(),a.m(n,null)))},i(t){if(!r){for(let t=0;t<s.length;t+=1)T(o[t]);r=!0}},o(t){for(let t=0;t<o.length;t+=1)F(o[t]);r=!1},d(t){t&&(d(e),d(n)),i&&i.d(t);for(let t=0;t<o.length;t+=1)o[t].d();a&&a.d()}}}function $e(t,e,n){let{votes:r}=e;return t.$$set=t=>{"votes"in t&&n(0,r=t.votes)},[r]}class be extends Q{constructor(t){super(),K(this,t,$e,ve,c,{votes:0})}}function ye(t,e,n){const r=t.slice();return r[10]=e[n],r}function xe(t,e,n){const r=t.slice();return r[13]=e[n],r[15]=n,r}function ke(t){let e,n,r;return{c(){e=p("div"),n=p("div"),r=m(t[4]),$(n,"class","alert alert-danger"),$(n,"role","alert"),$(e,"class","fixed-top")},m(t,o){u(t,e,o),a(e,n),a(n,r)},p(t,e){16&e&&b(r,t[4])},d(t){t&&d(e)}}}function we(t,e){let n,r,o;return r=new ht({props:{isRevealed:e[5],user:e[13],i:e[15],count:e[2]}}),{key:t,first:null,c(){n=h(),H(r.$$.fragment),this.first=n},m(t,e){u(t,n,e),q(r,t,e),o=!0},p(t,n){e=t;const o={};32&n&&(o.isRevealed=e[5]),1&n&&(o.user=e[13]),1&n&&(o.i=e[15]),4&n&&(o.count=e[2]),r.$set(o)},i(t){o||(T(r.$$.fragment,t),o=!0)},o(t){F(r.$$.fragment,t),o=!1},d(t){t&&d(n),Y(r,t)}}}function _e(t){let e,n;return e=new be({props:{votes:t[6]}}),{c(){H(e.$$.fragment)},m(t,r){q(e,t,r),n=!0},p(t,n){const r={};64&n&&(r.votes=t[6]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Se(t){let e;return{c(){e=m("âœ“")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function Ce(t){let e,n,r;return{c(){e=p("button"),e.textContent="Reveal",$(e,"class","btn btn-primary")},m(t,o){u(t,e,o),n||(r=v(e,"click",At),n=!0)},d(t){t&&d(e),n=!1,r()}}}function Ne(t){let e,n,r;return{c(){e=p("button"),e.textContent="Clear",$(e,"class","btn btn-warning")},m(t,o){u(t,e,o),n||(r=v(e,"click",jt),n=!0)},d(t){t&&d(e),n=!1,r()}}}function Ee(t){let e,n,r=L(t[8]),o=[];for(let e=0;e<r.length;e+=1)o[e]=We(ye(t,r,e));const c=t=>F(o[t],1,1,(()=>{o[t]=null}));return{c(){e=p("div");for(let t=0;t<o.length;t+=1)o[t].c();$(e,"class","d-flex justify-content-center")},m(t,r){u(t,e,r);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null);n=!0},p(t,n){if(416&n){let i;for(r=L(t[8]),i=0;i<r.length;i+=1){const c=ye(t,r,i);o[i]?(o[i].p(c,n),T(o[i],1)):(o[i]=We(c),o[i].c(),T(o[i],1),o[i].m(e,null))}for(X(),i=r.length;i<o.length;i+=1)c(i);B()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)T(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)F(o[t]);n=!1},d(t){t&&d(e),f(o,t)}}}function Oe(e){let n,r,o,c,i,s;return{c(){n=m("You joined as spectator."),r=p("br"),o=m("\n                I want to\n                "),c=p("button"),c.textContent="become a voter",$(c,"class","btn btn-light btn-sm")},m(t,l){u(t,n,l),u(t,r,l),u(t,o,l),u(t,c,l),i||(s=v(c,"click",e[9]),i=!0)},p:t,i:t,o:t,d(t){t&&(d(n),d(r),d(o),d(c)),i=!1,s()}}}function Re(t){let e,n,r=t[10]+"";return{c(){e=m(r),n=g()},m(t,r){u(t,e,r),u(t,n,r)},p(t,n){256&n&&r!==(r=t[10]+"")&&b(e,r)},d(t){t&&(d(e),d(n))}}}function We(t){let e,n;return e=new lt({props:{disabled:t[5],selected:t[10]==t[7].vote,$$slots:{default:[Re]},$$scope:{ctx:t}}}),e.$on("click",(function(){o(Jt(t[10]))&&Jt(t[10]).apply(this,arguments)})),e.$on("keypress",(function(){o(Jt(t[10]))&&Jt(t[10]).apply(this,arguments)})),{c(){H(e.$$.fragment)},m(t,r){q(e,t,r),n=!0},p(n,r){t=n;const o={};32&r&&(o.disabled=t[5]),384&r&&(o.selected=t[10]==t[7].vote),65792&r&&(o.$$scope={dirty:r,ctx:t}),e.$set(o)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ae(t){let e,n;return e=new Tt({}),{c(){H(e.$$.fragment)},m(t,r){q(e,t,r),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function je(t){let e,n,r,o,c,i,s,l,f,m,v,b,y,x,k,w,_,S,C,N=[],E=new Map,O=t[4]&&ke(t),R=L(t[0]);const W=t=>t[13].id;for(let e=0;e<R.length;e+=1){let n=xe(t,R,e),r=W(n);E.set(r,N[e]=we(r,n))}let A=t[5]&&_e(t),j=!t[5]&&t[3]&&Se();function J(t,e){return t[5]?Ne:Ce}let M=J(t),z=M(t);const I=[Oe,Ee],P=[];function G(t,e){return t[7].is_spectator?0:1}y=G(t),x=P[y]=I[y](t),w=new Gt({});let V=t[1]&&Ae();return{c(){O&&O.c(),e=g(),n=p("div");for(let t=0;t<N.length;t+=1)N[t].c();r=g(),o=p("div"),A&&A.c(),c=g(),i=p("div"),s=p("div"),j&&j.c(),l=g(),z.c(),f=g(),m=p("div"),v=p("div"),b=p("div"),x.c(),k=g(),H(w.$$.fragment),_=g(),V&&V.c(),S=h(),$(s,"class","voting-status svelte-n9crvd"),$(i,"class","d-flex justify-content-center mb-3"),$(o,"class","controls svelte-n9crvd"),$(n,"class","participants svelte-n9crvd"),$(b,"class","col"),$(v,"class","row"),$(m,"class","container text-center")},m(t,d){O&&O.m(t,d),u(t,e,d),u(t,n,d);for(let t=0;t<N.length;t+=1)N[t]&&N[t].m(n,null);a(n,r),a(n,o),A&&A.m(o,null),a(o,c),a(o,i),a(i,s),j&&j.m(s,null),a(i,l),z.m(i,null),u(t,f,d),u(t,m,d),a(m,v),a(v,b),P[y].m(b,null),a(m,k),q(w,m,null),u(t,_,d),V&&V.m(t,d),u(t,S,d),C=!0},p(t,[l]){t[4]?O?O.p(t,l):(O=ke(t),O.c(),O.m(e.parentNode,e)):O&&(O.d(1),O=null),37&l&&(R=L(t[0]),X(),N=D(N,l,W,1,t,R,E,n,U,we,r,xe),B()),t[5]?A?(A.p(t,l),32&l&&T(A,1)):(A=_e(t),A.c(),T(A,1),A.m(o,c)):A&&(X(),F(A,1,1,(()=>{A=null})),B()),!t[5]&&t[3]?j||(j=Se(),j.c(),j.m(s,null)):j&&(j.d(1),j=null),M!==(M=J(t))&&(z.d(1),z=M(t),z&&(z.c(),z.m(i,null)));let a=y;y=G(t),y===a?P[y].p(t,l):(X(),F(P[a],1,1,(()=>{P[a]=null})),B(),x=P[y],x?x.p(t,l):(x=P[y]=I[y](t),x.c()),T(x,1),x.m(b,null)),t[1]?V?2&l&&T(V,1):(V=Ae(),V.c(),T(V,1),V.m(S.parentNode,S)):V&&(X(),F(V,1,1,(()=>{V=null})),B())},i(t){if(!C){for(let t=0;t<R.length;t+=1)T(N[t]);T(A),T(x),T(w.$$.fragment,t),T(V),C=!0}},o(t){for(let t=0;t<N.length;t+=1)F(N[t]);F(A),F(x),F(w.$$.fragment,t),F(V),C=!1},d(t){t&&(d(e),d(n),d(f),d(m),d(_),d(S)),O&&O.d(t);for(let t=0;t<N.length;t+=1)N[t].d();A&&A.d(),j&&j.d(),z.d(),P[y].d(),Y(w),V&&V.d(t)}}}function Je(t,e,n){let r,o,c,i,l,a,u;s(t,bt,(t=>n(0,o=t))),s(t,Ct,(t=>n(4,c=t))),s(t,_t,(t=>n(5,i=t))),s(t,Nt,(t=>n(6,l=t))),s(t,St,(t=>n(7,a=t))),s(t,yt,(t=>n(8,u=t)));let d,f=!1;S((()=>{Wt(et("websocket_url")),n(1,f=new URLSearchParams(window.location.search).get("debug"))}));return t.$$.update=()=>{1&t.$$.dirty&&n(2,d=o.length),1&t.$$.dirty&&n(3,r=o.every((t=>t.is_spectator||t.vote)))},[o,f,d,r,c,i,l,a,u,()=>Rt("settings",{is_spectator:!1})]}class Me extends Q{constructor(t){super(),K(this,t,Je,je,c,{})}}function ze(t){let e,n;return e=new ct({}),{c(){H(e.$$.fragment)},m(t,r){q(e,t,r),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Ie(t){let e,n;return e=new Me({}),{c(){H(e.$$.fragment)},m(t,r){q(e,t,r),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function Pe(e){let n,r,o,c;const i=[Ie,ze],s=[];return n=function(t,e){return t[0]?0:1}(e),r=s[n]=i[n](e),{c(){r.c(),o=h()},m(t,e){s[n].m(t,e),u(t,o,e),c=!0},p:t,i(t){c||(T(r),c=!0)},o(t){F(r),c=!1},d(t){t&&d(o),s[n].d(t)}}}function Ge(t){return[et("websocket_url")]}return new class extends Q{constructor(t){super(),K(this,t,Ge,Pe,c,{})}}({target:document.querySelector("#poker")})}();
