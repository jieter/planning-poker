var app=function(){"use strict";function t(){}function e(t,e){for(const n in e)t[n]=e[n];return t}function n(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(n)}function i(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,...n){if(null==e){for(const t of n)t(void 0);return t}const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function s(t,e,n){t.$$.on_destroy.push(l(e,n))}function a(t,n,o,r){return t[1]&&r?e(o.ctx.slice(),t[1](r(n))):o.ctx}function u(t,e){const n={};e=new Set(e);for(const o in t)e.has(o)||"$"===o[0]||(n[o]=t[o]);return n}function d(t,e){t.appendChild(e)}function f(t,e,n){const o=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!o.getElementById(e)){const t=h("style");t.id=e,t.textContent=n,function(t,e){d(t.head||t,e),e.sheet}(o,t)}}function m(t,e,n){t.insertBefore(e,n||null)}function p(t){t.parentNode&&t.parentNode.removeChild(t)}function g(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function $(){return v(" ")}function b(){return v("")}function y(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}const w=["width","height"];function k(t,e){const n=Object.getOwnPropertyDescriptors(t.__proto__);for(const o in e)null==e[o]?t.removeAttribute(o):"style"===o?t.style.cssText=e[o]:"__value"===o?t.value=t[o]=e[o]:n[o]&&n[o].set&&-1===w.indexOf(o)?t[o]=e[o]:x(t,o,e[o])}function _(t,e){e=""+e,t.data!==e&&(t.data=e)}function S(t,e){t.value=null==e?"":e}function C(t,e,n,o){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function N(t,e,n){t.classList.toggle(e,!!n)}let z;function O(t){z=t}function E(t){(function(){if(!z)throw new Error("Function called outside component initialization");return z})().$$.on_mount.push(t)}const j=[],R=[];let A=[];const M=[],W=Promise.resolve();let J=!1;function B(t){A.push(t)}const I=new Set;let P=0;function G(){if(0!==P)return;const t=z;do{try{for(;P<j.length;){const t=j[P];P++,O(t),T(t.$$)}}catch(t){throw j.length=0,P=0,t}for(O(null),j.length=0,P=0;R.length;)R.pop()();for(let t=0;t<A.length;t+=1){const e=A[t];I.has(e)||(I.add(e),e())}A.length=0}while(j.length);for(;M.length;)M.pop()();J=!1,I.clear(),O(t)}function T(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(B)}}const X=new Set;let H;function D(){H={r:0,c:[],p:H}}function L(){H.r||r(H.c),H=H.p}function F(t,e){t&&t.i&&(X.delete(t),t.i(e))}function q(t,e,n,o){if(t&&t.o){if(X.has(t))return;X.add(t),H.c.push((()=>{X.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function U(t){return void 0!==t?.length?t:Array.from(t)}function V(t,e){q(t,1,1,(()=>{e.delete(t.key)}))}function Y(t,e,n,o,i,c,l,s,a,u,d,f){let m=t.length,p=c.length,g=m;const h={};for(;g--;)h[t[g].key]=g;const v=[],$=new Map,b=new Map,y=[];for(g=p;g--;){const t=f(i,c,g),r=n(t);let s=l.get(r);s?o&&y.push((()=>s.p(t,e))):(s=u(r,t),s.c()),$.set(r,v[g]=s),r in h&&b.set(r,Math.abs(g-h[r]))}const x=new Set,w=new Set;function k(t){F(t,1),t.m(s,d),l.set(t.key,t),d=t.first,p--}for(;m&&p;){const e=v[p-1],n=t[m-1],o=e.key,r=n.key;e===n?(d=e.first,m--,p--):$.has(r)?!l.has(o)||x.has(o)?k(e):w.has(r)?m--:b.get(o)>b.get(r)?(w.add(o),k(e)):(x.add(r),m--):(a(n,l),m--)}for(;m--;){const e=t[m];$.has(e.key)||a(e,l)}for(;p;)k(v[p-1]);return r(y),v}function K(t){t&&t.c()}function Q(t,e,o){const{fragment:c,after_update:l}=t.$$;c&&c.m(e,o),B((()=>{const e=t.$$.on_mount.map(n).filter(i);t.$$.on_destroy?t.$$.on_destroy.push(...e):r(e),t.$$.on_mount=[]})),l.forEach(B)}function Z(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];A.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),A=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function tt(t,e){-1===t.$$.dirty[0]&&(j.push(t),J||(J=!0,W.then(G)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function et(e,n,i,c,l,s,a=null,u=[-1]){const d=z;O(e);const f=e.$$={fragment:null,ctx:[],props:s,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(f.root);let m=!1;if(f.ctx=i?i(e,n.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=r)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](r),m&&tt(e,t)),n})):[],f.update(),m=!0,r(f.before_update),f.fragment=!!c&&c(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(p)}else f.fragment&&f.fragment.c();n.intro&&F(e.$$.fragment),Q(e,n.target,n.anchor),G()}O(d)}class nt{$$=void 0;$$set=void 0;$destroy(){Z(this,1),this.$destroy=t}$on(e,n){if(!i(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function ot(t){f(t,"svelte-gm52mk",".deck-card.svelte-gm52mk{display:flex;padding:6px 2px;justify-content:center;align-content:center;margin:2px 2px;flex-direction:column;border:1px solid rgba(0, 0, 0, 0.125);border-radius:0.25rem;transition:background-color 100ms ease-out 200ms}")}function rt(t){let e,n;const o=t[4].default,r=function(t,e,n,o){if(t){const r=a(t,e,n,o);return t[0](r)}}(o,t,t[3],null);return{c(){e=h("div"),r&&r.c(),x(e,"class","deck-card svelte-gm52mk"),C(e,"background-color",t[0]||"#d8f7ec"),C(e,"height",t[1]+"px"),C(e,"width",.65*t[1]+"px")},m(t,o){m(t,e,o),r&&r.m(e,null),n=!0},p(t,[i]){r&&r.p&&(!n||8&i)&&function(t,e,n,o,r,i){if(r){const c=a(e,n,o,i);t.p(c,r)}}(r,o,t,t[3],n?function(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}(o,t[3],i,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[3]),null),(!n||1&i)&&C(e,"background-color",t[0]||"#d8f7ec"),(!n||2&i)&&C(e,"height",t[1]+"px"),(!n||2&i)&&C(e,"width",.65*t[1]+"px")},i(t){n||(F(r,t),n=!0)},o(t){q(r,t),n=!1},d(t){t&&p(e),r&&r.d(t)}}}function it(t,e,n){let o,{$$slots:r={},$$scope:i}=e,{color:c=null}=e,{size:l="regular"}=e;return t.$$set=t=>{"color"in t&&n(0,c=t.color),"size"in t&&n(2,l=t.size),"$$scope"in t&&n(3,i=t.$$scope)},t.$$.update=()=>{4&t.$$.dirty&&n(1,o="sm"==l?45:70)},[c,o,l,i,r]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class ct extends nt{constructor(t){super(),et(this,t,it,rt,c,{color:0,size:2},ot)}}
/*! js-cookie v3.0.5 | MIT */function lt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}var st=function t(e,n){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=lt({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var c in r)r[c]&&(i+="; "+c,!0!==r[c]&&(i+="="+r[c].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+i}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],o={},r=0;r<n.length;r++){var i=n[r].split("="),c=i.slice(1).join("=");try{var l=decodeURIComponent(i[0]);if(o[l]=e.read(c,l),t===l)break}catch(t){}}return t?o[t]:o}},remove:function(t,e){o(t,"",lt({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,lt({},this.attributes,e))},withConverter:function(e){return t(lt({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});function at(t){let e=document.getElementById(t);if(e)return JSON.parse(e.textContent)}function ut(t){const e=Math.abs(t);return e>999?Math.sign(t)*(e/1e3).toFixed(1)+"k":Math.sign(t)*e}function dt(t,e,n){const o=t.slice();return o[7]=e[n],o}function ft(t,e,n){const o=t.slice();return o[10]=e[n][0],o[11]=e[n][1],o}function mt(t,e,n){const o=t.slice();return o[14]=e[n][0],o[15]=e[n][1],o}function pt(t){let e,n;return{c(){e=h("div"),n=v(t[2]),x(e,"class","invalid-feedback")},m(t,o){m(t,e,o),d(e,n)},p(t,e){4&e&&_(n,t[2])},d(t){t&&p(e)}}}function gt(t){let e,n,o,r,i,c,l,s=U(t[3].basic),a=[];for(let e=0;e<s.length;e+=1)a[e]=ht(mt(t,s,e));let u=U(t[3].decks),f=[];for(let e=0;e<u.length;e+=1)f[e]=bt(dt(t,u,e));const v=t=>q(f[t],1,1,(()=>{f[t]=null}));return{c(){e=h("div");for(let t=0;t<a.length;t+=1)a[t].c();n=$(),o=h("div"),o.textContent="Starting at 2023-10-01, ignoring single-vote rounds.",r=$(),i=h("div"),c=h("div");for(let t=0;t<f.length;t+=1)f[t].c();x(o,"class","light p-1"),C(o,"font-size","10px"),x(e,"class","col-md-3"),x(c,"class","m-1"),x(i,"class","col-md-6")},m(t,s){m(t,e,s);for(let t=0;t<a.length;t+=1)a[t]&&a[t].m(e,null);d(e,n),d(e,o),m(t,r,s),m(t,i,s),d(i,c);for(let t=0;t<f.length;t+=1)f[t]&&f[t].m(c,null);l=!0},p(t,o){if(8&o){let r;for(s=U(t[3].basic),r=0;r<s.length;r+=1){const i=mt(t,s,r);a[r]?a[r].p(i,o):(a[r]=ht(i),a[r].c(),a[r].m(e,n))}for(;r<a.length;r+=1)a[r].d(1);a.length=s.length}if(8&o){let e;for(u=U(t[3].decks),e=0;e<u.length;e+=1){const n=dt(t,u,e);f[e]?(f[e].p(n,o),F(f[e],1)):(f[e]=bt(n),f[e].c(),F(f[e],1),f[e].m(c,null))}for(D(),e=u.length;e<f.length;e+=1)v(e);L()}},i(t){if(!l){for(let t=0;t<u.length;t+=1)F(f[t]);l=!0}},o(t){f=f.filter(Boolean);for(let t=0;t<f.length;t+=1)q(f[t]);l=!1},d(t){t&&(p(e),p(r),p(i)),g(a,t),g(f,t)}}}function ht(t){let e,n,o,r,i,c=t[14]+"",l=t[15]+"";return{c(){e=h("div"),n=v(c),o=$(),r=h("span"),i=v(l),x(r,"class","badge bg-primary rounded-pill"),x(e,"class","d-flex justify-content-between align-items-center p-1")},m(t,c){m(t,e,c),d(e,n),d(e,o),d(e,r),d(r,i)},p(t,e){8&e&&c!==(c=t[14]+"")&&_(n,c),8&e&&l!==(l=t[15]+"")&&_(i,l)},d(t){t&&p(e)}}}function vt(t){let e,n=t[10]+"";return{c(){e=v(n)},m(t,n){m(t,e,n)},p(t,o){8&o&&n!==(n=t[10]+"")&&_(e,n)},d(t){t&&p(e)}}}function $t(t){let e,n,o,r,i,c,l=ut(t[11])+"";return n=new ct({props:{size:"sm",$$slots:{default:[vt]},$$scope:{ctx:t}}}),{c(){e=h("div"),K(n.$$.fragment),o=$(),r=h("div"),i=v(l),x(r,"class","text-muted"),x(e,"class","d-inline-block text-center")},m(t,l){m(t,e,l),Q(n,e,null),d(e,o),d(e,r),d(r,i),c=!0},p(t,e){const o={};262152&e&&(o.$$scope={dirty:e,ctx:t}),n.$set(o),(!c||8&e)&&l!==(l=ut(t[11])+"")&&_(i,l)},i(t){c||(F(n.$$.fragment,t),c=!0)},o(t){q(n.$$.fragment,t),c=!1},d(t){t&&p(e),Z(n)}}}function bt(t){let e,n,o,r=U(t[7]),i=[];for(let e=0;e<r.length;e+=1)i[e]=$t(ft(t,r,e));const c=t=>q(i[t],1,1,(()=>{i[t]=null}));return{c(){e=h("div");for(let t=0;t<i.length;t+=1)i[t].c();n=$(),x(e,"class","d-flex overflow-scroll")},m(t,r){m(t,e,r);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,null);d(e,n),o=!0},p(t,o){if(8&o){let l;for(r=U(t[7]),l=0;l<r.length;l+=1){const c=ft(t,r,l);i[l]?(i[l].p(c,o),F(i[l],1)):(i[l]=$t(c),i[l].c(),F(i[l],1),i[l].m(e,n))}for(D(),l=r.length;l<i.length;l+=1)c(l);L()}},i(t){if(!o){for(let t=0;t<r.length;t+=1)F(i[t]);o=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)q(i[t]);o=!1},d(t){t&&p(e),g(i,t)}}}function yt(t){let e,n,o,i,c,l,s,a,u,f,g,b,w,k,_,C,z,O,E,j,R,A,M,W,J,B,I,P,G,T,X,H,U=t[2]&&pt(t),V=t[3]&&gt(t);return{c(){e=h("div"),n=h("div"),o=h("div"),i=h("h1"),i.textContent="Planning poker",c=$(),l=h("form"),s=h("div"),a=h("input"),u=$(),f=h("div"),g=h("input"),b=$(),U&&U.c(),w=$(),k=h("div"),k.innerHTML='<input type="submit" class="btn btn-primary" value="Join"/>',_=$(),C=h("div"),z=h("label"),O=h("input"),E=v(" Join as a spectator 👁️"),j=$(),R=h("span"),R.textContent="You can always enable voting later",A=$(),M=h("div"),W=h("div"),J=h("hr"),B=$(),I=h("div"),V&&V.c(),P=$(),G=h("div"),G.innerHTML='GitHub: <a href="https://github.com/jieter/planning-poker">jieter/planning-poker</a>',x(i,"class","mt-4"),x(a,"type","hidden"),x(a,"name","csrfmiddlewaretoken"),a.value=st.get("csrftoken"),x(g,"type","text"),x(g,"name","name"),x(g,"class","form-control"),N(g,"is-invalid",t[2]),x(f,"class","col"),x(k,"class","col"),x(s,"class","row row-cols-lg-auto"),x(O,"type","checkbox"),x(O,"name","is_spectator"),x(z,"class","col"),x(R,"class","text-muted"),x(C,"class","row"),x(l,"method","post"),x(o,"class","col"),x(n,"class","row"),x(e,"class","container"),x(G,"class","col-md-2"),x(I,"class","row"),x(W,"class","container small"),x(M,"class","fixed-bottom mb-3")},m(r,p){m(r,e,p),d(e,n),d(n,o),d(o,i),d(o,c),d(o,l),d(l,s),d(s,a),d(s,u),d(s,f),d(f,g),S(g,t[0]),d(f,b),U&&U.m(f,null),d(s,w),d(s,k),d(l,_),d(l,C),d(C,z),d(z,O),O.checked=t[1],d(z,E),d(C,j),d(C,R),m(r,A,p),m(r,M,p),d(M,W),d(W,J),d(W,B),d(W,I),V&&V.m(I,null),d(I,P),d(I,G),T=!0,X||(H=[y(g,"change",t[4]),y(g,"input",t[5]),y(O,"change",t[6])],X=!0)},p(t,[e]){1&e&&g.value!==t[0]&&S(g,t[0]),(!T||4&e)&&N(g,"is-invalid",t[2]),t[2]?U?U.p(t,e):(U=pt(t),U.c(),U.m(f,null)):U&&(U.d(1),U=null),2&e&&(O.checked=t[1]),t[3]?V?(V.p(t,e),8&e&&F(V,1)):(V=gt(t),V.c(),F(V,1),V.m(I,P)):V&&(D(),q(V,1,1,(()=>{V=null})),L())},i(t){T||(F(V),T=!0)},o(t){q(V),T=!1},d(t){t&&(p(e),p(A),p(M)),U&&U.d(),V&&V.d(),X=!1,r(H)}}}function xt(t,e,n){let o,r,i="",c=null;E((()=>{const t=localStorage.getItem("name");t&&n(0,i=t);const e=localStorage.getItem("isSpectator");null!==e&&n(1,c="true"===e),n(3,r=at("statistics")),console.log(r)}));return t.$$.update=()=>{1&t.$$.dirty&&i&&localStorage.setItem("name",i),2&t.$$.dirty&&null!=c&&localStorage.setItem("isSpectator",c?"true":"false")},[i,c,o,r,()=>{n(2,o=i?void 0:"Name cannot be empty")},function(){i=this.value,n(0,i)},function(){c=this.checked,n(1,c)}]}class wt extends nt{constructor(t){super(),et(this,t,xt,yt,c,{})}}const kt=[];function _t(e,n=t){let o;const r=new Set;function i(t){if(c(e,t)&&(e=t,o)){const t=!kt.length;for(const t of r)t[1](),kt.push(t,e);if(t){for(let t=0;t<kt.length;t+=2)kt[t][0](kt[t+1]);kt.length=0}}}function l(t){i(t(e))}return{set:i,update:l,subscribe:function(c,s=t){const a=[c,s];return r.add(a),1===r.size&&(o=n(i,l)||t),c(e),()=>{r.delete(a),0===r.size&&o&&(o(),o=null)}}}}function St(e,n,o){const c=!Array.isArray(e),s=c?[e]:e;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=n.length<2;return u=(e,o)=>{let u=!1;const d=[];let f=0,m=t;const p=()=>{if(f)return;m();const r=n(c?d[0]:d,e,o);a?e(r):m=i(r)?r:t},g=s.map(((t,e)=>l(t,(t=>{d[e]=t,f&=~(1<<e),u&&p()}),(()=>{f|=1<<e}))));return u=!0,p(),function(){r(g),m(),u=!1}},{subscribe:_t(o,u).subscribe};var u}const Ct=_t([]),Nt=_t([]),zt=_t([]),Ot=_t(!1),Et=_t("tshirt"),jt=_t(!1),Rt=_t({}),At=_t(void 0),Mt=_t([]),Wt=_t(0);function Jt(t){const e=new Proxy({},{get:(t,e)=>e in t?t[e]:0});return t.forEach((t=>{null!=t&&(e[t]+=1)})),Object.entries(e).sort(((t,e)=>e[1]-t[1]))}const Bt=St(Ct,(t=>Jt(t.map((t=>t.vote))))),It=St([jt,Bt],(([t,e])=>t&&1==e.length&&e[0]&&e[0][1]>1)),Pt=St(Ct,(t=>t.every((t=>t.is_spectator||t.vote)))),Gt=St([Ct,Rt,It,jt],(([t,e,n,o])=>{if(n)return"🎉";if(o)return"🃏";const r=t.filter((t=>!t.is_spectator)),i=r.filter((t=>t.vote)),c=r.length-i.length==1;return r.length>1&&!e.vote&&c?"🚨":"🕶️"})),Tt=t=>{Rt.update((e=>(e.vote=t,e)))};let Xt;function Ht(t,e=void 0){Xt&&1==Xt.readyState?((e=e||{}).action=t,console.log("update",e),Xt.send(JSON.stringify(e))):console.log("Socket not open yet")}function Dt(t){Xt=new WebSocket(t),Xt.onclose=()=>{At.set("WebSocket connection closed unexpectedly. Trying to reconnect in 2s..."),setTimeout((()=>{console.log("Reconnecting..."),Dt(t)}),2e3)},Xt.onopen=()=>{Ht({action:"init"})},Xt.onmessage=t=>{const e=JSON.parse(t.data);switch(console.log("message",e),e.type){case"init":Ct.set(e.users),Rt.set(e.user),Nt.set(e.settings.choices),Ot.set(e.settings.auto_reveal),jt.set(e.settings.is_revealed),zt.set(e.settings.decks),Et.set(e.settings.deck),Mt.set(e.log),At.set(void 0),Wt.set(e.reveal_count);break;case"vote":Ct.update((t=>(t.forEach((t=>{t.id==e.user_id&&(t.vote=e.value)})),[...t])));break;case"error":At.set(e.message)}}}const Lt=()=>Ht("reveal"),Ft=()=>{Tt(null),Ht("clear")};function qt(t){return()=>{(function(t){let e;return l(t,(t=>e=t))(),e})(jt)||(Ht("vote",{value:t}),Tt(t))}}function Ut(t,e,n){const o=t.slice();return o[14]=e[n],o}function Vt(t){let e,n,o,r,i,c,l,s,a=t[14].time+"",u=t[14].event+"",f=JSON.stringify(t[14].data)+"";return{c(){e=h("div"),n=h("span"),o=v(a),r=$(),i=v(u),c=$(),l=v(f),s=$()},m(t,a){m(t,e,a),d(e,n),d(n,o),d(e,r),d(e,i),d(e,c),d(e,l),d(e,s)},p(t,e){16&e&&a!==(a=t[14].time+"")&&_(o,a),16&e&&u!==(u=t[14].event+"")&&_(i,u),16&e&&f!==(f=JSON.stringify(t[14].data)+"")&&_(l,f)},d(t){t&&p(e)}}}function Yt(e){let n,o,i,c,l,s,a,u,f,b,w,k,S,C,N,z,O,E,j,R,A,M,W,J,B=JSON.stringify(e[0])+"",I=JSON.stringify(e[1])+"",P=JSON.stringify(e[2])+"",G=JSON.stringify(e[3])+"",T=!e[5]&&function(t){let e,n,o,i,c;return{c(){e=h("button"),e.textContent="Add fake users",n=$(),o=h("button"),o.textContent="Add fake votes",x(e,"class","btn btn-xs btn-warning"),x(o,"class","btn btn-xs btn-warning")},m(r,l){m(r,e,l),m(r,n,l),m(r,o,l),i||(c=[y(e,"click",t[12]),y(o,"click",t[13])],i=!0)},d(t){t&&(p(e),p(n),p(o)),i=!1,r(c)}}}(e),X=U(e[4]),H=[];for(let t=0;t<X.length;t+=1)H[t]=Vt(Ut(e,X,t));return{c(){n=h("div"),o=h("div"),i=h("div"),c=v("debug"),l=h("code"),s=v(B),a=$(),u=h("div"),f=v("votes: "),b=h("code"),w=v(I),k=$(),S=h("div"),C=v("user: "),N=h("code"),z=v(P),O=$(),E=h("div"),j=v("participants: "),R=h("code"),A=v(G),M=$(),T&&T.c(),W=$(),J=h("div");for(let t=0;t<H.length;t+=1)H[t].c();x(o,"class","col"),x(J,"class","col"),x(n,"class","row bg-light rounded p-2 small mb-5")},m(t,e){m(t,n,e),d(n,o),d(o,i),d(i,c),d(i,l),d(l,s),d(o,a),d(o,u),d(u,f),d(u,b),d(b,w),d(o,k),d(o,S),d(S,C),d(S,N),d(N,z),d(o,O),d(o,E),d(E,j),d(E,R),d(R,A),d(o,M),T&&T.m(o,null),d(n,W),d(n,J);for(let t=0;t<H.length;t+=1)H[t]&&H[t].m(J,null)},p(t,[e]){if(1&e&&B!==(B=JSON.stringify(t[0])+"")&&_(s,B),2&e&&I!==(I=JSON.stringify(t[1])+"")&&_(w,I),4&e&&P!==(P=JSON.stringify(t[2])+"")&&_(z,P),8&e&&G!==(G=JSON.stringify(t[3])+"")&&_(A,G),16&e){let n;for(X=U(t[4]),n=0;n<X.length;n+=1){const o=Ut(t,X,n);H[n]?H[n].p(o,e):(H[n]=Vt(o),H[n].c(),H[n].m(J,null))}for(;n<H.length;n+=1)H[n].d(1);H.length=X.length}},i:t,o:t,d(t){t&&p(n),T&&T.d(),g(H,t)}}}function Kt(t,e,n){let o,r,i,c,l,a,u,d,f,m,p;s(t,Ot,(t=>n(6,r=t))),s(t,jt,(t=>n(7,i=t))),s(t,Nt,(t=>n(8,c=t))),s(t,zt,(t=>n(9,l=t))),s(t,Et,(t=>n(10,a=t))),s(t,At,(t=>n(11,u=t))),s(t,Bt,(t=>n(1,d=t))),s(t,Rt,(t=>n(2,f=t))),s(t,Ct,(t=>n(3,m=t))),s(t,Mt,(t=>n(4,p=t)));const g=!window.location.host.includes("localhost");return t.$$.update=()=>{4032&t.$$.dirty&&n(0,o={error:u,deck:a,decks:l,choices:c,isRevealed:i,autoReveal:r})},[o,d,f,m,p,g,r,i,c,l,a,u,()=>Ht("add_fakes"),()=>Ht("fake_votes")]}Et.subscribe((t=>Ht("settings",{deck:t}))),Ot.subscribe((t=>Ht("settings",{auto_reveal:t})));class Qt extends nt{constructor(t){super(),et(this,t,Kt,Yt,c,{})}}const Zt=(t,e={})=>{xe(e);let{colors:n=["#FFC700","#FF0000","#2E3191","#41BBC7"],duration:o=3500,force:r=.5,particleCount:i=150,particleShape:c="mix",particleSize:l=12,destroyAfterDone:s=!0,stageHeight:a=800,stageWidth:u=1600}=e;!function(t){const e=ue("style");e.dataset.neoconfetti="",e.textContent='@keyframes fk9XWG_y-axis{to{transform:translate3d(0,var(--stage-height),0)}}@keyframes fk9XWG_x-axis{to{transform:translate3d(var(--x-landing-point),0,0)}}@keyframes fk9XWG_rotation{50%{transform:rotate3d(var(--half-rotation),180deg)}to{transform:rotate3d(var(--rotation),360deg)}}.fk9XWG_container{width:0;height:0;z-index:1200;position:relative;overflow:visible}.fk9XWG_particle{animation:x-axis var(--duration-chaos)forwards cubic-bezier(var(--x1),var(--x2),var(--x3),var(--x4));animation-name:fk9XWG_x-axis}.fk9XWG_particle>div{animation:y-axis var(--duration-chaos)forwards cubic-bezier(var(--y1),var(--y2),var(--y3),var(--y4));width:var(--width);height:var(--height);animation-name:fk9XWG_y-axis;position:absolute;top:0;left:0}.fk9XWG_particle>div:before{height:100%;width:100%;content:"";background-color:var(--bgcolor);animation:rotation var(--rotation-duration)infinite linear;border-radius:var(--border-radius);animation-name:fk9XWG_rotation;display:block}',de(document.head,e)}(),t.classList.add("fk9XWG_container"),t.style.setProperty("--stage-height",a+"px");let d,f=fe(i,n),m=te(t,f);function p(t,e){const n=se(le()*(ve-1)),i="rectangles"!==c&&("circles"===c||$e(n)),s=(e,n)=>t.style.setProperty(e,n+"");s("--x-landing-point",pe(ce(ge(e,90)-180),0,180,-u/2,u/2)+"px"),s("--duration-chaos",o-se(1e3*le())+"ms");const a=le()<oe?me(le()*re,2):0;s("--x1",a),s("--x2",-1*a),s("--x3",a),s("--x4",me(ce(pe(ce(ge(e,90)-180),0,180,-1,1)),4)),s("--y1",me(le()*ie,4)),s("--y2",me(le()*r*(he()?1:-1),4)),s("--y3",ie),s("--y4",me(ae(pe(ce(e-180),0,180,r,-r),0),4)),s("--width",(i?l:se(4*le())+l/2)+"px"),s("--height",(i?l:se(2*le())+l)+"px");const d=n.toString(2).padStart(3,"0").split("");s("--half-rotation",d.map((t=>+t/2+""))),s("--rotation",d),s("--rotation-duration",me(le()*(ne-ee)+ee)+"ms"),s("--border-radius",i?"50%":0)}for(const[t,e]of Object.entries(m))p(e,f[+t].degree);return Promise.resolve().then((()=>d=setTimeout((()=>s&&(t.innerHTML="")),o))),{update(e){xe(e);const p=e.particleCount??i,g=e.colors??n,h=e.stageHeight??a;if(f=fe(p,g),p===i&&JSON.stringify(n)!==JSON.stringify(g))for(const[t,{color:e}]of Object.entries(f))m[+t].style.setProperty("--bgcolor",e);p!==i&&(t.innerHTML="",m=te(t,f)),s&&!e.destroyAfterDone&&clearTimeout(d),t.style.setProperty("--stage-height",h+"px"),n=g,o=e.duration??o,r=e.force??r,i=p,c=e.particleShape??c,l=e.particleSize??l,s=e.destroyAfterDone??s,a=h,u=e.stageWidth??u},destroy(){clearTimeout(d)}}};function te(t,e=[]){const n=[];for(const{color:o}of e){const e=ue("div");e.className="fk9XWG_particle",e.style.setProperty("--bgcolor",o);const r=ue("div");de(e,r),de(t,e),n.push(e)}return n}const ee=200,ne=800,oe=.1,re=.3,ie=.5,ce=Math.abs,le=Math.random,se=Math.round,ae=Math.max,ue=t=>document.createElement(t),de=(t,e)=>t.appendChild(e),fe=(t,e)=>Array.from({length:t},((n,o)=>({color:e[o%e.length],degree:360*o/t}))),me=(t,e=2)=>se((t+Number.EPSILON)*10**e)/10**e,pe=(t,e,n,o,r)=>(t-e)*(r-o)/(n-e)+o,ge=(t,e)=>t+e>360?t+e-360:t+e,he=()=>le()>.5,ve=6,$e=t=>1!==t&&he(),be=t=>void 0===t,ye=(t,e)=>{if(!be(t)&&Number.isSafeInteger(t)&&t<0)throw new Error(e+" must be a positive integer")},xe=({particleCount:t,duration:e,colors:n,particleSize:o,force:r,stageHeight:i,stageWidth:c,particleShape:l})=>{if(ye(t,"particleCount"),ye(e,"duration"),ye(o,"particleSize"),ye(r,"force"),ye(i,"stageHeight"),ye(c,"stageWidth"),!be(l)&&!/^(mix|circles|rectangles)$/i.test(l))throw new Error('particlesShape should be either "mix" or "circles" or "rectangle"');if(!be(n)&&!Array.isArray(n))throw new Error("colors must be an array of strings");if(r>1)throw new Error("force must be within 0 and 1")};function we(t,e,n){const o=t.slice();return o[5]=e[n][0],o[6]=e[n][1],o}function ke(e){let n,o,r;return{c(){n=h("div")},m(e,c){var l;m(e,n,c),o||(l=Zt.call(null,n),r=l&&i(l.destroy)?l.destroy:t,o=!0)},d(t){t&&p(n),o=!1,r()}}}function _e(e){let n;return{c(){n=h("div"),n.textContent="No votes",x(n,"class","col text-center p-2")},m(t,e){m(t,n,e)},p:t,d(t){t&&p(n)}}}function Se(t){let e,n=t[5]+"";return{c(){e=v(n)},m(t,n){m(t,e,n)},p(t,o){1&o&&n!==(n=t[5]+"")&&_(e,n)},d(t){t&&p(e)}}}function Ce(t,e){let n,o,r,i,c,l,s,a,u=e[6]+"";return o=new ct({props:{size:e[1],$$slots:{default:[Se]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=h("div"),K(o.$$.fragment),r=$(),i=h("div"),c=v(u),l=v("x"),s=$(),x(i,"class","text-muted"),x(n,"class","d-inline-block text-center"),this.first=n},m(t,e){m(t,n,e),Q(o,n,null),d(n,r),d(n,i),d(i,c),d(i,l),d(n,s),a=!0},p(t,n){e=t;const r={};2&n&&(r.size=e[1]),513&n&&(r.$$scope={dirty:n,ctx:e}),o.$set(r),(!a||1&n)&&u!==(u=e[6]+"")&&_(c,u)},i(t){a||(F(o.$$.fragment,t),a=!0)},o(t){q(o.$$.fragment,t),a=!1},d(t){t&&p(n),Z(o)}}}function Ne(t){let n,o,r,i=[],c=new Map,l=t[2]&&t[3]&&ke(),s=U(t[0]);const a=t=>t[5];for(let e=0;e<s.length;e+=1){let n=we(t,s,e),o=a(n);c.set(o,i[e]=Ce(o,n))}let u=null;s.length||(u=_e());let d=[t[4]],f={};for(let t=0;t<d.length;t+=1)f=e(f,d[t]);return{c(){l&&l.c(),n=$(),o=h("div");for(let t=0;t<i.length;t+=1)i[t].c();u&&u.c(),k(o,f)},m(t,e){l&&l.m(t,e),m(t,n,e),m(t,o,e);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(o,null);u&&u.m(o,null),r=!0},p(t,[e]){t[2]&&t[3]?l||(l=ke(),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null),3&e&&(s=U(t[0]),D(),i=Y(i,e,a,1,t,s,c,o,V,Ce,null,we),L(),!s.length&&u?u.p(t,e):s.length?u&&(u.d(1),u=null):(u=_e(),u.c(),u.m(o,null))),k(o,f=function(t,e){const n={},o={},r={$$scope:1};let i=t.length;for(;i--;){const c=t[i],l=e[i];if(l){for(const t in c)t in l||(o[t]=1);for(const t in l)r[t]||(n[t]=l[t],r[t]=1);t[i]=l}else for(const t in c)r[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(d,[16&e&&t[4]]))},i(t){if(!r){for(let t=0;t<s.length;t+=1)F(i[t]);r=!0}},o(t){for(let t=0;t<i.length;t+=1)q(i[t]);r=!1},d(t){t&&(p(n),p(o)),l&&l.d(t);for(let t=0;t<i.length;t+=1)i[t].d();u&&u.d()}}}function ze(t,n,o){const r=["votes","size","emitConfetti"];let i,c=u(n,r);s(t,It,(t=>o(3,i=t)));let{votes:l}=n,{size:a}=n,{emitConfetti:d=!0}=n;return t.$$set=t=>{n=e(e({},n),function(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}(t)),o(4,c=u(n,r)),"votes"in t&&o(0,l=t.votes),"size"in t&&o(1,a=t.size),"emitConfetti"in t&&o(2,d=t.emitConfetti)},[l,a,d,i,c]}class Oe extends nt{constructor(t){super(),et(this,t,ze,Ne,c,{votes:0,size:1,emitConfetti:2})}}function Ee(t){f(t,"svelte-n1eljq",".voting-round.svelte-n1eljq{writing-mode:vertical-lr}.history-item.svelte-n1eljq{background-color:#efefef}")}function je(t,e,n){const o=t.slice();o[4]=e[n].data;const r=Jt(o[4].votes);return o[5]=r,o}function Re(t){let e,n,o;function r(t,e){return t[0]?Je:We}let i=r(t),c=i(t);return{c(){c.c(),e=v(" previous "),n=v(t[1]),o=v(" rounds")},m(t,r){c.m(t,r),m(t,e,r),m(t,n,r),m(t,o,r)},p(t,o){i!==(i=r(t))&&(c.d(1),c=i(t),c&&(c.c(),c.m(e.parentNode,e))),2&o&&_(n,t[1])},d(t){t&&(p(e),p(n),p(o)),c.d(t)}}}function Ae(t){let e;function n(t,e){return t[0]?Ie:Be}let o=n(t),r=o(t);return{c(){r.c(),e=v(" previous votes")},m(t,n){r.m(t,n),m(t,e,n)},p(t,i){o!==(o=n(t))&&(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&p(e),r.d(t)}}}function Me(e){let n;return{c(){n=v("No history yet.")},m(t,e){m(t,n,e)},p:t,d(t){t&&p(n)}}}function We(t){let e;return{c(){e=v("Hide")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Je(t){let e;return{c(){e=v("Show")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Be(t){let e;return{c(){e=v("Hide")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Ie(t){let e;return{c(){e=v("Show")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Pe(t){let e;function n(t,e){return t[0]?Te:Ge}let o=n(t),r=o(t);return{c(){r.c(),e=b()},m(t,n){r.m(t,n),m(t,e,n)},p(t,i){o!==(o=n(t))&&(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&p(e),r.d(t)}}}function Ge(t){let e;return{c(){e=v("▼")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Te(t){let e;return{c(){e=v("▲")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function Xe(t){let e,n,o=U(t[2].filter(qe)),r=[];for(let e=0;e<o.length;e+=1)r[e]=Le(je(t,o,e));const i=t=>q(r[t],1,1,(()=>{r[t]=null}));return{c(){e=h("div");for(let t=0;t<r.length;t+=1)r[t].c();x(e,"class","d-flex overflow-scroll mb-2 text-muted")},m(t,o){m(t,e,o);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null);n=!0},p(t,n){if(4&n){let c;for(o=U(t[2].filter(qe)),c=0;c<o.length;c+=1){const i=je(t,o,c);r[c]?(r[c].p(i,n),F(r[c],1)):(r[c]=Le(i),r[c].c(),F(r[c],1),r[c].m(e,null))}for(D(),c=o.length;c<r.length;c+=1)i(c);L()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)q(r[t]);n=!1},d(t){t&&p(e),g(r,t)}}}function He(t){let e,n;return{c(){e=h("br"),n=v("no votes")},m(t,o){m(t,e,o),m(t,n,o)},d(t){t&&(p(e),p(n))}}}function De(t){let e,n,o,r;return n=new Oe({props:{votes:t[5],emitConfetti:!1,size:"sm"}}),{c(){e=h("div"),K(n.$$.fragment),o=$(),x(e,"class","small history-item text-start rounded flex-shrink-0 m-1 p-1 svelte-n1eljq")},m(t,i){m(t,e,i),Q(n,e,null),d(e,o),r=!0},p(t,e){const o={};4&e&&(o.votes=t[5]),n.$set(o)},i(t){r||(F(n.$$.fragment,t),r=!0)},o(t){q(n.$$.fragment,t),r=!1},d(t){t&&p(e),Z(n)}}}function Le(t){let e,n,o,r,i,c,l,s=t[4].round+"",a=0==t[5].length&&He(),u=t[5].length>0&&De(t);return{c(){e=h("small"),n=v("Round "),o=v(s),r=$(),a&&a.c(),i=$(),u&&u.c(),c=b(),x(e,"class","voting-round ms-1 text-center svelte-n1eljq")},m(t,s){m(t,e,s),d(e,n),d(e,o),d(e,r),a&&a.m(e,null),m(t,i,s),u&&u.m(t,s),m(t,c,s),l=!0},p(t,n){(!l||4&n)&&s!==(s=t[4].round+"")&&_(o,s),0==t[5].length?a||(a=He(),a.c(),a.m(e,null)):a&&(a.d(1),a=null),t[5].length>0?u?(u.p(t,n),4&n&&F(u,1)):(u=De(t),u.c(),F(u,1),u.m(c.parentNode,c)):u&&(D(),q(u,1,1,(()=>{u=null})),L())},i(t){l||(F(u),l=!0)},o(t){q(u),l=!1},d(t){t&&(p(e),p(i),p(c)),a&&a.d(),u&&u.d(t)}}}function Fe(t){let e,n,o,i,c,l,s;function a(t,e){return 0==t[1]?Me:1==t[1]?Ae:Re}let u=a(t),f=u(t),g=t[1]>0&&Pe(t),v=!t[0]&&Xe(t);return{c(){e=h("div"),f.c(),n=$(),g&&g.c(),o=$(),v&&v.c(),i=b(),x(e,"role","button"),x(e,"class","text-muted my-1 mx-2 small"),x(e,"tabindex","0")},m(r,a){m(r,e,a),f.m(e,null),d(e,n),g&&g.m(e,null),m(r,o,a),v&&v.m(r,a),m(r,i,a),c=!0,l||(s=[y(e,"click",t[3]),y(e,"keypress",t[3])],l=!0)},p(t,[o]){u===(u=a(t))&&f?f.p(t,o):(f.d(1),f=u(t),f&&(f.c(),f.m(e,n))),t[1]>0?g?g.p(t,o):(g=Pe(t),g.c(),g.m(e,null)):g&&(g.d(1),g=null),t[0]?v&&(D(),q(v,1,1,(()=>{v=null})),L()):v?(v.p(t,o),1&o&&F(v,1)):(v=Xe(t),v.c(),F(v,1),v.m(i.parentNode,i))},i(t){c||(F(v),c=!0)},o(t){q(v),c=!1},d(t){t&&(p(e),p(o),p(i)),f.d(),g&&g.d(),v&&v.d(t),l=!1,r(s)}}}const qe=t=>"reveal"==t.event;function Ue(t,e,n){let o,r;s(t,Wt,(t=>n(1,o=t))),s(t,Mt,(t=>n(2,r=t)));let i=!0;return[i,o,r,function(){n(0,i=!i)}]}class Ve extends nt{constructor(t){super(),et(this,t,Ue,Fe,c,{},Ee)}}function Ye(t){f(t,"svelte-10w4gcr",".participant.svelte-10w4gcr{display:block;position:absolute;text-align:center;top:95%;left:50%;margin:-2em}")}function Ke(t){let e;function n(t,e){return t[1]?tn:Ze}let o=n(t),r=o(t);return{c(){r.c(),e=b()},m(t,n){r.m(t,n),m(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&p(e),r.d(t)}}}function Qe(e){let n;return{c(){n=v("👁️")},m(t,e){m(t,n,e)},p:t,d(t){t&&p(n)}}}function Ze(e){let n;return{c(){n=v("⌛")},m(t,e){m(t,n,e)},p:t,d(t){t&&p(n)}}}function tn(t){let e,n=t[0].vote+"";return{c(){e=v(n)},m(t,n){m(t,e,n)},p(t,o){1&o&&n!==(n=t[0].vote+"")&&_(e,n)},d(t){t&&p(e)}}}function en(t){let e;function n(t,e){return t[0].is_spectator?Qe:t[0].vote?Ke:void 0}let o=n(t),r=o&&o(t);return{c(){r&&r.c(),e=b()},m(t,n){r&&r.m(t,n),m(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r&&r.d(1),r=o&&o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&p(e),r&&r.d(t)}}}function nn(t){let e,n,o,r,i,c,l=t[0].name+"";return i=new ct({props:{color:t[0].is_spectator?"#effbf7":void 0,$$slots:{default:[en]},$$scope:{ctx:t}}}),{c(){e=h("div"),n=h("strong"),o=v(l),r=$(),K(i.$$.fragment),x(e,"class","participant svelte-10w4gcr"),C(e,"transform","rotate("+t[2]+"deg) translate(37.5vw) rotate(90deg)")},m(t,l){m(t,e,l),d(e,n),d(n,o),d(e,r),Q(i,e,null),c=!0},p(t,[n]){(!c||1&n)&&l!==(l=t[0].name+"")&&_(o,l);const r={};1&n&&(r.color=t[0].is_spectator?"#effbf7":void 0),35&n&&(r.$$scope={dirty:n,ctx:t}),i.$set(r),(!c||4&n)&&C(e,"transform","rotate("+t[2]+"deg) translate(37.5vw) rotate(90deg)")},i(t){c||(F(i.$$.fragment,t),c=!0)},o(t){q(i.$$.fragment,t),c=!1},d(t){t&&p(e),Z(i)}}}function on(t,e,n){let o,{user:r}=e,{isRevealed:i}=e,{i:c}=e,{count:l}=e;return t.$$set=t=>{"user"in t&&n(0,r=t.user),"isRevealed"in t&&n(1,i=t.isRevealed),"i"in t&&n(3,c=t.i),"count"in t&&n(4,l=t.count)},t.$$.update=()=>{28&t.$$.dirty&&(n(2,o=-90),l>1&&n(2,o-=Math.min(20,174/l)*(c-(l-1)/2)))},[r,i,o,c,l]}class rn extends nt{constructor(t){super(),et(this,t,on,nn,c,{user:0,isRevealed:1,i:3,count:4},Ye)}}function cn(t){f(t,"svelte-1y9hivi","label.svelte-1y9hivi{white-space:nowrap}.btn-sm.svelte-1y9hivi{width:100px}.voting-status.svelte-1y9hivi{width:1.5em;color:green}")}function ln(t,e,n){const o=t.slice();return o[8]=e[n][0],o[9]=e[n][1],o}function sn(t){let e,n,o,r,i,c,l,s,a,u,f,g=!1,b=t[9]+"";return a=function(t){let e;return{p(...n){e=n,e.forEach((e=>t.push(e)))},r(){e.forEach((e=>t.splice(t.indexOf(e),1)))}}}(t[6][0]),{c(){e=h("input"),i=$(),c=h("label"),l=v(b),x(e,"type","radio"),x(e,"class","btn-check"),e.__value=n=t[8],S(e,e.__value),x(e,"autocomplete","off"),x(e,"id",o="deck-"+t[8]),e.disabled=r=!t[1],x(c,"class","btn btn-outline-primary svelte-1y9hivi"),x(c,"for",s="deck-"+t[8]),a.p(e)},m(n,o){m(n,e,o),e.checked=e.__value===t[2],m(n,i,o),m(n,c,o),d(c,l),u||(f=y(e,"change",t[5]),u=!0)},p(t,i){1&i&&n!==(n=t[8])&&(e.__value=n,S(e,e.__value),g=!0),1&i&&o!==(o="deck-"+t[8])&&x(e,"id",o),2&i&&r!==(r=!t[1])&&(e.disabled=r),(g||5&i)&&(e.checked=e.__value===t[2]),1&i&&b!==(b=t[9]+"")&&_(l,b),1&i&&s!==(s="deck-"+t[8])&&x(c,"for",s)},d(t){t&&(p(e),p(i),p(c)),a.r(),u=!1,f()}}}function an(t){let e;function n(t,e){return!t[1]&&t[4]?dn:un}let o=n(t),r=o(t);return{c(){r.c(),e=b()},m(t,n){r.m(t,n),m(t,e,n)},p(t,i){o!==(o=n(t))&&(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){t&&p(e),r.d(t)}}}function un(t){let e;return{c(){e=h("div"),e.textContent="~",x(e,"class","voting-status svelte-1y9hivi"),x(e,"title","Voting in progress")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function dn(t){let e;return{c(){e=h("div"),e.textContent="✓",x(e,"class","voting-status svelte-1y9hivi"),x(e,"title","Voting complete")},m(t,n){m(t,e,n)},d(t){t&&p(e)}}}function fn(t){let e,n,o;return{c(){e=h("button"),e.textContent="Reveal",x(e,"class","btn btn-sm btn-success svelte-1y9hivi")},m(t,r){m(t,e,r),n||(o=y(e,"click",Lt),n=!0)},d(t){t&&p(e),n=!1,o()}}}function mn(t){let e,n,o;return{c(){e=h("button"),e.textContent="Clear",x(e,"class","btn btn-sm btn-warning svelte-1y9hivi")},m(t,r){m(t,e,r),n||(o=y(e,"click",Ft),n=!0)},d(t){t&&p(e),n=!1,o()}}}function pn(e){let n,o,r,i,c,l,s,a,u,f,b,w=U(e[0]),k=[];for(let t=0;t<w.length;t+=1)k[t]=sn(ln(e,w,t));let _=!e[3]&&an(e);function S(t,e){return t[1]?mn:fn}let C=S(e),N=C(e);return{c(){n=h("div"),o=h("div");for(let t=0;t<k.length;t+=1)k[t].c();r=v("\n     \n\n    "),_&&_.c(),i=$(),N.c(),c=$(),l=h("div"),s=h("label"),s.textContent="Auto reveal",a=$(),u=h("input"),x(o,"class","btn-group btn-group-sm"),x(o,"role","group"),x(o,"aria-label","Change deck"),x(s,"for","autoReveal"),x(s,"class","svelte-1y9hivi"),x(u,"type","checkbox"),x(u,"class","form-check-input"),x(u,"id","autoReveal"),x(l,"class","form-check form-switch mt-1 ms-3"),x(n,"class","d-flex justify-content-center m-3")},m(t,p){m(t,n,p),d(n,o);for(let t=0;t<k.length;t+=1)k[t]&&k[t].m(o,null);d(n,r),_&&_.m(n,null),d(n,i),N.m(n,null),d(n,c),d(n,l),d(l,s),d(l,a),d(l,u),u.checked=e[3],f||(b=y(u,"change",e[7]),f=!0)},p(t,[e]){if(7&e){let n;for(w=U(t[0]),n=0;n<w.length;n+=1){const r=ln(t,w,n);k[n]?k[n].p(r,e):(k[n]=sn(r),k[n].c(),k[n].m(o,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=w.length}t[3]?_&&(_.d(1),_=null):_?_.p(t,e):(_=an(t),_.c(),_.m(n,i)),C!==(C=S(t))&&(N.d(1),N=C(t),N&&(N.c(),N.m(n,c))),8&e&&(u.checked=t[3])},i:t,o:t,d(t){t&&p(n),g(k,t),_&&_.d(),N.d(),f=!1,b()}}}function gn(t,e,n){let o,r,i,c,l;s(t,zt,(t=>n(0,o=t))),s(t,jt,(t=>n(1,r=t))),s(t,Et,(t=>n(2,i=t))),s(t,Ot,(t=>n(3,c=t))),s(t,Pt,(t=>n(4,l=t)));return[o,r,i,c,l,function(){i=this.__value,Et.set(i)},[[]],function(){c=this.checked,Ot.set(c)}]}class hn extends nt{constructor(t){super(),et(this,t,gn,pn,c,{},cn)}}function vn(t){f(t,"svelte-1rvs6lz",".participants.svelte-1rvs6lz{width:80vw;height:40vw;border-radius:40vw 40vw 0 0;position:relative;background-color:#eee;margin:4vh auto}.controls.svelte-1rvs6lz{position:absolute;bottom:0;left:50%;transform:translateX(-50%)}button.selected.svelte-1rvs6lz{font-weight:bold;margin:-8px 0 8px 0 !important;transition:margin 100ms ease-in-out 100ms,\n        font-weight 100ms ease-out 100ms}")}function $n(t,e,n){const o=t.slice();return o[9]=e[n],o}function bn(t,e,n){const o=t.slice();return o[12]=e[n],o[14]=n,o}function yn(t){let e,n,o;return{c(){e=h("div"),n=h("div"),o=v(t[1]),x(n,"class","alert alert-danger"),x(n,"role","alert"),x(e,"class","fixed-top")},m(t,r){m(t,e,r),d(e,n),d(n,o)},p(t,e){2&e&&_(o,t[1])},d(t){t&&p(e)}}}function xn(t,e){let n,o,r;return o=new rn({props:{isRevealed:e[3],user:e[12],i:e[14],count:e[2].length}}),{key:t,first:null,c(){n=b(),K(o.$$.fragment),this.first=n},m(t,e){m(t,n,e),Q(o,t,e),r=!0},p(t,n){e=t;const r={};8&n&&(r.isRevealed=e[3]),4&n&&(r.user=e[12]),4&n&&(r.i=e[14]),4&n&&(r.count=e[2].length),o.$set(r)},i(t){r||(F(o.$$.fragment,t),r=!0)},o(t){q(o.$$.fragment,t),r=!1},d(t){t&&p(n),Z(o,t)}}}function wn(t){let e,n,o;return n=new Oe({props:{votes:t[4],style:"background-color: #e6e6e6;",class:"p-2 mb-2 text-center rounded"}}),{c(){e=h("div"),K(n.$$.fragment),x(e,"class","controls svelte-1rvs6lz")},m(t,r){m(t,e,r),Q(n,e,null),o=!0},p(t,e){const o={};16&e&&(o.votes=t[4]),n.$set(o)},i(t){o||(F(n.$$.fragment,t),o=!0)},o(t){q(n.$$.fragment,t),o=!1},d(t){t&&p(e),Z(n)}}}function kn(t){let e,n,o=U(t[6]),r=[];for(let e=0;e<o.length;e+=1)r[e]=Cn($n(t,o,e));const i=t=>q(r[t],1,1,(()=>{r[t]=null}));return{c(){e=h("div");for(let t=0;t<r.length;t+=1)r[t].c();x(e,"class","d-flex justify-content-center")},m(t,o){m(t,e,o);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null);n=!0},p(t,n){if(104&n){let c;for(o=U(t[6]),c=0;c<o.length;c+=1){const i=$n(t,o,c);r[c]?(r[c].p(i,n),F(r[c],1)):(r[c]=Cn(i),r[c].c(),F(r[c],1),r[c].m(e,null))}for(D(),c=o.length;c<r.length;c+=1)i(c);L()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)F(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)q(r[t]);n=!1},d(t){t&&p(e),g(r,t)}}}function _n(e){let n,o,r,i,c,l;return{c(){n=v("You joined as spectator."),o=h("br"),r=v("\n                I want to\n                "),i=h("button"),i.textContent="become a voter",x(i,"class","btn btn-light btn-sm")},m(t,s){m(t,n,s),m(t,o,s),m(t,r,s),m(t,i,s),c||(l=y(i,"click",e[8]),c=!0)},p:t,i:t,o:t,d(t){t&&(p(n),p(o),p(r),p(i)),c=!1,l()}}}function Sn(t){let e,n=t[9]+"";return{c(){e=v(n)},m(t,n){m(t,e,n)},p(t,o){64&o&&n!==(n=t[9]+"")&&_(e,n)},d(t){t&&p(e)}}}function Cn(t){let e,n,o,c,l,s;return n=new ct({props:{color:t[3]?"#eee":null,$$slots:{default:[Sn]},$$scope:{ctx:t}}}),{c(){e=h("button"),K(n.$$.fragment),o=$(),e.disabled=t[3],x(e,"class","btn m-0 p-0 svelte-1rvs6lz"),N(e,"selected",t[9]==t[5].vote)},m(r,a){m(r,e,a),Q(n,e,null),d(e,o),c=!0,l||(s=[y(e,"click",(function(){i(qt(t[9]))&&qt(t[9]).apply(this,arguments)})),y(e,"keypress",(function(){i(qt(t[9]))&&qt(t[9]).apply(this,arguments)}))],l=!0)},p(o,r){t=o;const i={};8&r&&(i.color=t[3]?"#eee":null),32832&r&&(i.$$scope={dirty:r,ctx:t}),n.$set(i),(!c||8&r)&&(e.disabled=t[3]),(!c||96&r)&&N(e,"selected",t[9]==t[5].vote)},i(t){c||(F(n.$$.fragment,t),c=!0)},o(t){q(n.$$.fragment,t),c=!1},d(t){t&&p(e),Z(n),l=!1,r(s)}}}function Nn(t){let e,n;return e=new Qt({}),{c(){K(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function zn(t){let e,n,o,r,i,c,l,s,a,u,f,g,v,b,y,w,k,_,S,N=[],z=new Map,O=t[1]&&yn(t),E=U(t[2]);const j=t=>t[12].id;for(let e=0;e<E.length;e+=1){let n=bn(t,E,e),o=j(n);z.set(o,N[e]=xn(o,n))}let R=t[3]&&wn(t);const A=[_n,kn],M=[];function W(t,e){return t[5].is_spectator?0:1}s=W(t),a=M[s]=A[s](t),g=new hn({});let J=t[0]&&Nn();return _=new Ve({}),{c(){O&&O.c(),e=$(),n=h("div");for(let t=0;t<N.length;t+=1)N[t].c();o=$(),R&&R.c(),r=$(),i=h("div"),c=h("div"),l=h("div"),a.c(),u=$(),f=h("div"),K(g.$$.fragment),v=$(),J&&J.c(),b=$(),y=h("div"),y.textContent=" ",w=$(),k=h("div"),K(_.$$.fragment),x(n,"class","participants svelte-1rvs6lz"),x(l,"class","col"),x(c,"class","row"),x(f,"class","row"),x(i,"class","container text-center"),x(y,"class","my-5"),x(k,"class","fixed-bottom bg-white"),C(k,"border-top","1px solid rgba(0, 0, 0, 0.125)")},m(t,a){O&&O.m(t,a),m(t,e,a),m(t,n,a);for(let t=0;t<N.length;t+=1)N[t]&&N[t].m(n,null);d(n,o),R&&R.m(n,null),m(t,r,a),m(t,i,a),d(i,c),d(c,l),M[s].m(l,null),d(i,u),d(i,f),Q(g,f,null),m(t,v,a),J&&J.m(t,a),m(t,b,a),m(t,y,a),m(t,w,a),m(t,k,a),Q(_,k,null),S=!0},p(t,[r]){t[1]?O?O.p(t,r):(O=yn(t),O.c(),O.m(e.parentNode,e)):O&&(O.d(1),O=null),12&r&&(E=U(t[2]),D(),N=Y(N,r,j,1,t,E,z,n,V,xn,o,bn),L()),t[3]?R?(R.p(t,r),8&r&&F(R,1)):(R=wn(t),R.c(),F(R,1),R.m(n,null)):R&&(D(),q(R,1,1,(()=>{R=null})),L());let i=s;s=W(t),s===i?M[s].p(t,r):(D(),q(M[i],1,1,(()=>{M[i]=null})),L(),a=M[s],a?a.p(t,r):(a=M[s]=A[s](t),a.c()),F(a,1),a.m(l,null)),t[0]?J?1&r&&F(J,1):(J=Nn(),J.c(),F(J,1),J.m(b.parentNode,b)):J&&(D(),q(J,1,1,(()=>{J=null})),L())},i(t){if(!S){for(let t=0;t<E.length;t+=1)F(N[t]);F(R),F(a),F(g.$$.fragment,t),F(J),F(_.$$.fragment,t),S=!0}},o(t){for(let t=0;t<N.length;t+=1)q(N[t]);q(R),q(a),q(g.$$.fragment,t),q(J),q(_.$$.fragment,t),S=!1},d(t){t&&(p(e),p(n),p(r),p(i),p(v),p(b),p(y),p(w),p(k)),O&&O.d(t);for(let t=0;t<N.length;t+=1)N[t].d();R&&R.d(),M[s].d(),Z(g),J&&J.d(t),Z(_)}}}function On(t,e,n){let o,r,i,c,l,a,u;s(t,Gt,(t=>n(7,o=t))),s(t,At,(t=>n(1,r=t))),s(t,Ct,(t=>n(2,i=t))),s(t,jt,(t=>n(3,c=t))),s(t,Bt,(t=>n(4,l=t))),s(t,Rt,(t=>n(5,a=t))),s(t,Nt,(t=>n(6,u=t)));let d=!1;E((()=>{Dt(at("websocket_url")),n(0,d=new URLSearchParams(window.location.search).get("debug"))}));return t.$$.update=()=>{128&t.$$.dirty&&function(t){const e=window.document,n=e.querySelector("link[rel*='icon']")||e.createElement("link");n.type="image/svg+xml",n.rel="shortcut icon",n.href=function(t){return`data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22256%22 height=%22256%22 viewBox=%220 0 100 100%22><text x=%2250%%22 y=%2250%%22 dominant-baseline=%22central%22 text-anchor=%22middle%22 font-size=%2280%22>${t}</text></svg>`}(t),e.getElementsByTagName("head")[0].appendChild(n)}(o)},[d,r,i,c,l,a,u,o,()=>Ht("settings",{is_spectator:!1})]}class En extends nt{constructor(t){super(),et(this,t,On,zn,c,{},vn)}}function jn(t){let e,n;return e=new wt({}),{c(){K(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function Rn(t){let e,n;return e=new En({}),{c(){K(e.$$.fragment)},m(t,o){Q(e,t,o),n=!0},i(t){n||(F(e.$$.fragment,t),n=!0)},o(t){q(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function An(e){let n,o,r,i;const c=[Rn,jn],l=[];return n=function(t,e){return t[0]?0:1}(e),o=l[n]=c[n](e),{c(){o.c(),r=b()},m(t,e){l[n].m(t,e),m(t,r,e),i=!0},p:t,i(t){i||(F(o),i=!0)},o(t){q(o),i=!1},d(t){t&&p(r),l[n].d(t)}}}function Mn(t){return[at("websocket_url")]}return new class extends nt{constructor(t){super(),et(this,t,Mn,An,c,{})}}({target:document.querySelector("#poker")})}();
